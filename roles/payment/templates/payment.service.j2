[Unit]
Description = Payment Service

[Service]
# Security Hardening: Running as a restricted system user
User=roboshop
WorkingDirectory=/app

# Dynamic Environment Variables
Environment=CART_HOST="{{ CART_HOST }}"
Environment=CART_PORT=8080
Environment=USER_HOST="{{ USER_HOST }}"
Environment=USER_PORT=8080
Environment=AMQP_HOST="{{ RABBITMQ_HOST }}"
Environment=AMQP_USER=roboshop
Environment=AMQP_PASS=roboshop123

# Python uWSGI Execution
ExecStart=/usr/local/bin/uwsgi --ini payment.ini
ExecStop=/bin/kill -9 $MAINPID
SyslogIdentifier=payment

[Install]
WantedBy=multi-user.target